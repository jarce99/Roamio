customElements.get("facet-form")||customElements.define("facet-form",class extends HTMLFormElement{constructor(){super(),this.dirty=!1,this.cachedMap=new Map,this.addEventListener("change",this.onFormChange),this.addEventListener("submit",this.onFormSubmit)}onFormChange(){this.dirty=!0,this.dispatchEvent(new Event("submit",{cancelable:!0}))}onFormSubmit(e){var t;e.preventDefault(),this.dirty&&(t=this.buildUrl().toString(),this.renderSection(t,e))}buildUrl(){var e=new URLSearchParams(new FormData(this));let n=new URL(this.action);return n.search="",e.forEach((e,t)=>n.searchParams.append(t,e)),["page","filter.v.price.gte","filter.v.price.lte"].forEach(e=>{""===n.searchParams.get(e)&&n.searchParams.delete(e)}),n.searchParams.set("section_id",theme.utils.sectionId(this)),n}updateURLHash(e){e=new URL(e);e.searchParams.delete("section_id"),history.replaceState({},"",e.toString())}beforeRenderSection(){var e=document.getElementById("ProductGridContainer"),t=e.querySelectorAll(".product-card"),n=theme.config.motionReduced?0:50;Motion.timeline([[t,{y:n,opacity:0,visibility:"hidden"},{duration:.5,delay:theme.config.motionReduced?0:Motion.stagger(.1)}],[e,{y:n,opacity:0},{duration:.5,easing:"linear"}]]),setTimeout(()=>{var e=document.querySelector(".collection"),e=(window.scrollTo({top:e.getBoundingClientRect().top+window.scrollY-(theme.config.isTouch||theme.config.mqlSmall?95:20),behavior:theme.config.motionReduced?"auto":"smooth"}),document.getElementById("FacetDrawer"));e&&e.classList.add("loading")},100)}afterRenderSection(){var e=document.getElementById("ProductGridContainer"),t=e.querySelectorAll(".product-card"),n=theme.config.motionReduced?0:50,e=(Motion.timeline([[e,{y:[n,0],opacity:[0,1]},{duration:.5,easing:"linear"}],[t,{y:[n,0],opacity:[0,1],visibility:["hidden","visible"]},{duration:.5,delay:theme.config.motionReduced?0:Motion.stagger(.1)}]]),document.getElementById("FacetDrawer"));e&&e.classList.remove("loading"),document.dispatchEvent(new CustomEvent("collection:reloaded"))}renderSection(e,t){this.cachedMap.has(e)?this.renderSectionFromCache(e,t):this.renderSectionFromFetch(e,t),this.hasAttribute("data-history")&&this.updateURLHash(e),this.dirty=!1}renderSectionFromFetch(n,r){this.abortController?.abort(),this.abortController=new AbortController,this.beforeRenderSection();let i=performance.now();fetch(n,{signal:this.abortController.signal}).then(e=>e.text()).then(e=>{var t=performance.now()-i;setTimeout(()=>{this.renderFilters(e,r),this.renderFiltersActive(e),this.renderProductGridContainer(e),this.renderProductCount(e),this.renderSortBy(e),theme.pubsub.publish(theme.pubsub.PUB_SUB_EVENTS.facetUpdate,{responseText:e}),this.cachedMap.set(n,e),this.afterRenderSection()},500<t?0:500)}).catch(e=>{"AbortError"===e.name?console.log("Fetch aborted by user"):console.error(e)})}renderSectionFromCache(t,n){this.beforeRenderSection(),setTimeout(()=>{var e=this.cachedMap.get(t);this.renderFilters(e,n),this.renderFiltersActive(e),this.renderProductGridContainer(e),this.renderProductCount(e),this.renderSortBy(e),theme.pubsub.publish(theme.pubsub.PUB_SUB_EVENTS.facetUpdate,{responseText:e}),this.afterRenderSection()},500)}renderFilters(e,n){e=(new DOMParser).parseFromString(e,"text/html").querySelectorAll("#FacetFiltersContainer [data-filter], #MobileFacetFiltersContainer [data-filter]");Array.from(e).filter(e=>{return e=e,!(!!(t=n?n.target.closest("[data-filter]"):void 0)&&e.getAttribute("data-index")===t.getAttribute("data-index"));var t}).forEach(e=>{var t=document.querySelector(`[data-filter][data-index="${e.getAttribute("data-index")}"]`);null!==t&&("DETAILS"===t.tagName?t.querySelector("summary + *").innerHTML=e.querySelector("summary + *").innerHTML:t.innerHTML=e.innerHTML)})}renderFiltersActive(e){var t="FacetFiltersActive";null!==document.getElementById(t)&&(e=(new DOMParser).parseFromString(e,"text/html"),document.getElementById(t).innerHTML=e.getElementById(t).innerHTML)}renderProductGridContainer(e){var t="ProductGridContainer";null!==document.getElementById(t)&&((e=(new DOMParser).parseFromString(e,"text/html")).querySelector("motion-list").setAttribute("motion-reduced",""),document.getElementById(t).innerHTML=e.getElementById(t).innerHTML)}renderProductCount(e){var t="ProductCount";null!==document.getElementById(t)&&(e=(new DOMParser).parseFromString(e,"text/html"),document.getElementById(t).innerHTML=e.getElementById(t).innerHTML)}renderSortBy(e){var t="SortByContainer";null!==document.getElementById(t)&&(e=(new DOMParser).parseFromString(e,"text/html"),document.getElementById(t).innerHTML=e.getElementById(t).innerHTML)}},{extends:"form"}),customElements.get("facet-count")||customElements.define("facet-count",class extends HTMLElement{constructor(){super()}facetUpdateUnsubscriber=void 0;connectedCallback(){this.facetUpdateUnsubscriber=theme.pubsub.subscribe(theme.pubsub.PUB_SUB_EVENTS.facetUpdate,this.onFacetUpdate.bind(this))}disconnectedCallback(){this.facetUpdateUnsubscriber&&this.facetUpdateUnsubscriber()}get itemCount(){return parseInt(this.innerText)}onFacetUpdate(e){e=(new DOMParser).parseFromString(e.responseText,"text/html").querySelector("facet-count");this.innerText=e.innerHTML,this.hidden=0===this.itemCount}}),customElements.get("facet-remove")||customElements.define("facet-remove",class extends MagnetLink{constructor(){super(),this.addEventListener("click",this.onClick)}onClick(e){var t,n=this.closest('form[is="facet-form"]')||document.querySelector('form[is="facet-form"]');n&&(e.preventDefault(),(t=new URL(this.href)).searchParams.set("section_id",theme.utils.sectionId(n)),n.renderSection(t.toString(),e))}},{extends:"a"}),customElements.get("facet-sort")||customElements.define("facet-sort",class extends HTMLElement{constructor(){super(),Motion.inView(this,this.init.bind(this),{margin:"200px 0px 200px 0px"}),this.addEventListener("change",this.onChange),this.button.addEventListener("click",this.show.bind(this)),this.close.addEventListener("click",this.hide.bind(this)),document.addEventListener("click",this.onWindowClick.bind(this))}get listbox(){return this.querySelector(".sort-listbox")}get selection(){return this.querySelector(".sort-selection")}get button(){return this.querySelector(".sort-by")}get close(){return this.querySelector(".sort-close")}init(){this.initButton(),this.style.setProperty("--facet-listbox-height",this.listbox.getBoundingClientRect().height+"px")}initButton(){var e=this.selection.innerText,e=theme.getElementWidth(this.selection,e);this.style.setProperty("--facet-button-width",e+"px")}onChange(e){var t,n=this.closest('form[is="facet-form"]')||document.querySelector('form[is="facet-form"]');n&&((t=new URL(window.location.href)).searchParams.set("sort_by",e.target.value),t.searchParams.set("section_id",theme.utils.sectionId(n)),t.searchParams.delete("page"),n.renderSection(t.toString(),e)),this.selection.innerText=e.target.nextElementSibling.innerText,this.initButton(),this.hide()}show(){this.button.setAttribute("open","")}hide(e=!0){var t;this.button.hasAttribute("open")&&(setTimeout(()=>{this.button.removeAttribute("open")},100),theme.config.isTouch||"none"===document.body.getAttribute("data-button-hover")||(t=this.button.querySelector("[data-fill"),Motion.animate(t,{y:["0%",e?"0%":"-76%"]},{duration:.6,delay:e?0:.2})))}onWindowClick(e){this.contains(e.target)||this.button.hasAttribute("open")&&this.hide(!1)}}),customElements.get("facet-sticky")||customElements.define("facet-sticky",class extends HTMLElement{constructor(){super(),new IntersectionObserver(this.handleIntersection.bind(this),{rootMargin:`-${screen.availHeight-100}px 0px ${screen.availHeight}px 0px`}).observe(document.querySelector(".collection-section"))}get button(){return this.querySelector(".button")}handleIntersection(e){e[0].isIntersecting?Motion.animate(this.button,{opacity:1,visibility:"visible",transform:["translateY(15px)","translateY(0)"]},{duration:1,easing:[.16,1,.3,1]}):Motion.animate(this.button,{opacity:0,visibility:"hidden",transform:["translateY(0)","translateY(15px)"]},{duration:1,easing:[.16,1,.3,1]})}}),customElements.get("price-range")||customElements.define("price-range",class extends HTMLElement{constructor(){super(),this.rangeMin=this.querySelector('input[type="range"]:first-child'),this.rangeMax=this.querySelector('input[type="range"]:last-child'),this.inputMin=this.querySelector('input[name="filter.v.price.gte"]'),this.inputMax=this.querySelector('input[name="filter.v.price.lte"]'),this.inputMin.addEventListener("focus",this.inputMin.select),this.inputMax.addEventListener("focus",this.inputMax.select),this.inputMin.addEventListener("change",this.onInputMinChange.bind(this)),this.inputMax.addEventListener("change",this.onInputMaxChange.bind(this)),this.rangeMin.addEventListener("change",this.onRangeMinChange.bind(this)),this.rangeMax.addEventListener("change",this.onRangeMaxChange.bind(this)),this.rangeMin.addEventListener("input",this.onRangeMinInput.bind(this)),this.rangeMax.addEventListener("input",this.onRangeMaxInput.bind(this))}onInputMinChange(e){e.preventDefault(),e.target.value=Math.max(Math.min(parseInt(e.target.value),parseInt(this.inputMax.value||e.target.max)-1),e.target.min),this.rangeMin.value=e.target.value,this.rangeMin.parentElement.style.setProperty("--range-min",parseInt(this.rangeMin.value)/parseInt(this.rangeMin.max)*100+"%")}onInputMaxChange(e){e.preventDefault(),e.target.value=Math.min(Math.max(parseInt(e.target.value),parseInt(this.inputMin.value||e.target.min)+1),e.target.max),this.rangeMax.value=e.target.value,this.rangeMax.parentElement.style.setProperty("--range-max",parseInt(this.rangeMax.value)/parseInt(this.rangeMax.max)*100+"%")}onRangeMinChange(e){e.stopPropagation(),this.inputMin.value=e.target.value,this.inputMin.dispatchEvent(new Event("change",{bubbles:!0}))}onRangeMaxChange(e){e.stopPropagation(),this.inputMax.value=e.target.value,this.inputMax.dispatchEvent(new Event("change",{bubbles:!0}))}onRangeMinInput(e){e.target.value=Math.min(parseInt(e.target.value),parseInt(this.inputMax.value||e.target.max)-1),e.target.parentElement.style.setProperty("--range-min",parseInt(e.target.value)/parseInt(e.target.max)*100+"%"),this.inputMin.value=e.target.value}onRangeMaxInput(e){e.target.value=Math.max(parseInt(e.target.value),parseInt(this.inputMin.value||e.target.min)+1),e.target.parentElement.style.setProperty("--range-max",parseInt(e.target.value)/parseInt(e.target.max)*100+"%"),this.inputMax.value=e.target.value}}),customElements.get("infinite-button")||customElements.define("infinite-button",class extends HoverButton{constructor(){super(),this.onClickHandler=this.onClick.bind(this)}connectedCallback(){this.addEventListener("click",this.onClickHandler),"infinite"==this.getAttribute("mode")&&Motion.inView(this,this.onClickHandler,{margin:"200px 0px 200px 0px"})}disconnectedCallback(){this.removeEventListener("click",this.onClickHandler)}onClick(){var e;this.hasAttribute("aria-busy")||(this.abortController?.abort(),this.abortController=new AbortController,this.enableLoading(),e=this.buildUrl().toString(),fetch(e,{signal:this.abortController.signal}).then(e=>e.text()).then(e=>{this.renderPagination(e),this.renderProductGridContainer(e)}).catch(e=>{"AbortError"===e.name?console.log("Fetch aborted by user"):console.error(e)}))}renderPagination(e){var t=document.getElementById("ProductGridContainer");null!==t&&(e=(new DOMParser).parseFromString(e,"text/html"),t=t.querySelector(".pagination"),(e=e.querySelector(".pagination"))?t.innerHTML=e.innerHTML:t.remove())}renderProductGridContainer(e){var n=document.getElementById("ProductGridContainer");if(null!==n){e=(new DOMParser).parseFromString(e,"text/html");let t=n.querySelector("motion-list");n=e.querySelector("motion-list");n&&t&&(n.querySelectorAll(".card").forEach(e=>{t.appendChild(e)}),t.reload())}}buildUrl(){var e=new URL(this.getAttribute("action"));return e.searchParams.set("section_id",theme.utils.sectionId(this)),e}enableLoading(){this.classList.add("pointer-events-none"),this.setAttribute("aria-busy","true")}},{extends:"button"});