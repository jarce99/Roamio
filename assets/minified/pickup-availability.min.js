customElements.get("pickup-availability")||customElements.define("pickup-availability",class extends HTMLElement{constructor(){super(),this.hasAttribute("available")&&(this.errorHtml=this.querySelector("template").content.firstElementChild.cloneNode(!0),this.onClickRefreshList=this.onClickRefreshList.bind(this),this.fetchAvailability(this.getAttribute("data-variant-id")))}fetchAvailability(t){let e=this.getAttribute("data-root-url");e.endsWith("/")||(e+="/");t=e+`variants/${t}/?section_id=pickup-availability`;fetch(t).then(t=>t.text()).then(t=>{t=(new DOMParser).parseFromString(t,"text/html").querySelector(".shopify-section");this.renderPreview(t)}).catch(()=>{var t=this.querySelector("button");t&&t.removeEventListener("click",this.onClickRefreshList),this.renderError()})}onClickRefreshList(){this.fetchAvailability(this.getAttribute("data-variant-id"))}update(t){t?.available?this.fetchAvailability(t.id):(this.innerHTML="",this.removeAttribute("available"),this.setAttribute("hidden",""))}renderError(){this.innerHTML="",this.appendChild(this.errorHtml),this.querySelector("button").addEventListener("click",this.onClickRefreshList)}renderPreview(t){var e=document.querySelector(".pickup-availability-drawer");e&&e.remove(),t.querySelector(".pickup-availability-preview")?(this.innerHTML=t.querySelector(".pickup-availability-preview").outerHTML,this.removeAttribute("hidden"),this.setAttribute("available",""),document.body.appendChild(t.querySelector(".pickup-availability-drawer"))):(this.innerHTML="",this.removeAttribute("available"),this.setAttribute("hidden",""))}});