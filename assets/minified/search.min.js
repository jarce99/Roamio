customElements.get("search-drawer")||customElements.define("search-drawer",class extends DrawerElement{constructor(){super()}get shouldAppendToBody(){return!1}get input(){return this.querySelector('input[type="search"]')}get focusElement(){return this.querySelector('input[type="search"]')}}),customElements.get("search-typed")||customElements.define("search-typed",class extends HTMLElement{constructor(){super(),Motion.inView(this,this.init.bind(this))}get startDelay(){return this.hasAttribute("data-delay")?parseFloat(this.getAttribute("data-delay")):0}async init(){this.insertCursor(),await this.start(this.getAttribute("data-first-text"),this.startDelay),setTimeout(async()=>{await this.reset(),await this.start(this.getAttribute("data-last-text"),0)},600)}async start(t,e){this.innerHTML=t,await Motion.animate(this,{width:[0,this.scrollWidth+"px"]},{duration:1,delay:e}).finished,this.cursor.classList.add("blink")}async reset(){this.cursor.classList.remove("blink"),await Motion.animate(this,{width:0},{duration:.25}).finished}insertCursor(){this.cursor||(this.cursor=document.createElement("span"),this.cursor.className="typed-cursor",this.cursor.setAttribute("aria-hidden",!0),this.cursor.innerHTML="|",this.parentElement.insertBefore(this.cursor,this.nextSibling))}}),customElements.get("predictive-search")||customElements.define("predictive-search",class extends HTMLFormElement{constructor(){super(),this.cachedMap=new Map,this.focusElement=this.input,this.resetButton.addEventListener("click",this.clear.bind(this)),this.input.addEventListener("click",this.hideTypewriter.bind(this)),this.input.addEventListener("input",theme.utils.debounce(this.onChange.bind(this),300)),this.input.addEventListener("focus",this.onFocus.bind(this))}get input(){return this.querySelector('input[type="search"]')}get resetButton(){return this.querySelector('button[type="reset"]')}get typewriter(){return this.input.previousElementSibling}hideTypewriter(){this.typewriter&&!this.typewriter.hasAttribute("hidden")&&this.typewriter.setAttribute("hidden","")}onFocus(t){var e;this.closest(".collection")&&(document.body.classList.add("predictive-search-open"),0!==this.getQuery().length)&&(e=this.buildUrl().toString(),this.renderSection(e,t))}clear(t=null){t&&t.preventDefault(),this.input.value="",this.input.focus(),this.removeAttribute("results")}getQuery(){return this.input.value.trim()}buildUrl(){var t=new URL(""+theme.routes.shop_url+theme.routes.predictive_search_url);return t.searchParams.set("q",this.getQuery()),t.searchParams.set("resources[limit]",this.hasAttribute("data-limit")?parseInt(this.getAttribute("data-limit")):3),t.searchParams.set("resources[limit_scope]","each"),t.searchParams.set("section_id",theme.utils.sectionId(this)),t}onChange(){var t;0===this.getQuery().length?this.clear():(this.hideTypewriter(),t=this.buildUrl().toString(),this.renderSection(t))}renderSection(t){this.cachedMap.has(t)?this.renderSectionFromCache(t):this.renderSectionFromFetch(t)}renderSectionFromCache(t){t=this.cachedMap.get(t);this.renderSearchResults(t),this.setAttribute("results","")}renderSectionFromFetch(e){this.abortController?.abort(),this.abortController=new AbortController,this.setAttribute("loading",""),fetch(e,{signal:this.abortController.signal}).then(t=>t.text()).then(t=>{this.renderSearchResults(t),this.cachedMap.set(e,t),this.removeAttribute("loading"),this.setAttribute("results","")}).catch(t=>{"AbortError"===t.name?console.log("Fetch aborted by user"):console.error(t)})}renderSearchResults(t){var e="PredictiveSearchResults-"+theme.utils.sectionId(this);null!==document.getElementById(e)&&(document.getElementById(e).innerHTML=(new DOMParser).parseFromString(t,"text/html").getElementById(e).innerHTML)}},{extends:"form"}),customElements.get("predictive-search-overlay")||customElements.define("predictive-search-overlay",class extends OverlayElement{constructor(){super(),this.addEventListener("click",this.onClick)}onClick(){setTimeout(()=>{document.body.classList.remove("predictive-search-open")})}});