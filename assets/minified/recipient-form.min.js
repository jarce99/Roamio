customElements.get("recipient-form")||customElements.define("recipient-form",class extends HTMLElement{constructor(){super(),this.recipientFieldsLiveRegion=this.querySelector(`#Recipient-fields-live-region-${this.sectionId}-`+this.productId),this.checkboxInput=this.querySelector(`#Recipient-checkbox-${this.sectionId}-`+this.productId),this.checkboxInput.disabled=!1,this.hiddenControlField=this.querySelector(`#Recipient-control-${this.sectionId}-`+this.productId),this.hiddenControlField.disabled=!0,this.fieldsContainer=this.querySelector(`#Recipient-fields-${this.sectionId}-`+this.productId),this.emailInput=this.querySelector(`#Recipient-email-${this.sectionId}-`+this.productId),this.nameInput=this.querySelector(`#Recipient-name-${this.sectionId}-`+this.productId),this.messageInput=this.querySelector(`#Recipient-message-${this.sectionId}-`+this.productId),this.sendonInput=this.querySelector(`#Recipient-send-on-${this.sectionId}-`+this.productId),this.offsetProperty=this.querySelector(`#Recipient-timezone-offset-${this.sectionId}-`+this.productId),this.offsetProperty&&(this.offsetProperty.value=(new Date).getTimezoneOffset().toString()),this.errorMessage=this.querySelector(".product-form__recipient-error-message"),this.errorMessageList=this.errorMessage?.querySelector("ul"),this.currentProductVariantId=this.getAttribute("data-product-variant-id"),this.addEventListener("change",this.onChange.bind(this)),this.onChange()}get sectionId(){return this.getAttribute("data-section-id")}get productId(){return this.getAttribute("data-product-id")}cartUpdateUnsubscriber=void 0;variantChangeUnsubscriber=void 0;cartErrorUnsubscriber=void 0;connectedCallback(){this.cartUpdateUnsubscriber=theme.pubsub.subscribe(theme.pubsub.PUB_SUB_EVENTS.cartUpdate,e=>{"product-form"===e.source&&e.productVariantId.toString()===this.currentProductVariantId&&this.resetRecipientForm()}),this.variantChangeUnsubscriber=theme.pubsub.subscribe(theme.pubsub.PUB_SUB_EVENTS.variantChange,e=>{e.data.sectionId===this.sectionId&&(this.currentProductVariantId=e.data.variant.id.toString())}),this.cartUpdateUnsubscriber=theme.pubsub.subscribe(theme.pubsub.PUB_SUB_EVENTS.cartError,e=>{"product-form"===e.source&&e.productVariantId.toString()===this.currentProductVariantId&&this.displayErrorMessage(e.message,e.errors)})}disconnectedCallback(){this.cartUpdateUnsubscriber&&this.cartUpdateUnsubscriber(),this.variantChangeUnsubscriber&&this.variantChangeUnsubscriber(),this.cartErrorUnsubscriber&&this.cartErrorUnsubscriber()}onChange(){this.checkboxInput.checked?(this.enableInputFields(),this.recipientFieldsLiveRegion.innerText=theme.recipientFormStrings.expanded):(this.clearInputFields(),this.disableInputFields(),this.clearErrorMessage(),this.recipientFieldsLiveRegion.innerText=theme.recipientFormStrings.collapsed),this.fieldsContainer.classList.toggle("hidden",!this.checkboxInput.checked)}inputFields(){return[this.emailInput,this.nameInput,this.messageInput,this.sendonInput]}disableableFields(){return[...this.inputFields(),this.offsetProperty]}clearInputFields(){this.inputFields().forEach(e=>e.value="")}enableInputFields(){this.disableableFields().forEach(e=>e.disabled=!1)}disableInputFields(){this.disableableFields().forEach(e=>e.disabled=!0)}displayErrorMessage(e,t){this.clearErrorMessage(),this.errorMessage.hidden=!1,"object"==typeof t&&Object.entries(t).forEach(([e,t])=>{t=""+t.join(", "),this.errorMessageList&&this.errorMessageList.appendChild(this.createErrorListItem(t)),t=this[e+"Input"];t&&t.classList.add("invalid")})}createErrorListItem(e){var t=document.createElement("li");return t.innerText=e,t}clearErrorMessage(){this.errorMessage.hidden=!0,this.errorMessageList&&(this.errorMessageList.innerHTML=""),[this.emailInput,this.messageInput,this.nameInput,this.sendonInput].forEach(e=>{e.classList.remove("invalid")})}resetRecipientForm(){this.checkboxInput.checked&&(this.checkboxInput.checked=!1,this.clearInputFields(),this.clearErrorMessage(),this.fieldsContainer.classList.add("hidden"))}});